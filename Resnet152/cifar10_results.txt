INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1', '/job:localhost/replica:0/task:0/device:GPU:2', '/job:localhost/replica:0/task:0/device:GPU:3')
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:batch_all_reduce: 640 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 640 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 640 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 640 all-reduces with algorithm = nccl, num_packs = 1
  1/313 [..............................] - ETA: 1:17:32  2/313 [..............................] - ETA: 27s      3/313 [..............................] - ETA: 27s  4/313 [..............................] - ETA: 27s  5/313 [..............................] - ETA: 27s  6/313 [..............................] - ETA: 27s  7/313 [..............................] - ETA: 26s  8/313 [..............................] - ETA: 26s  9/313 [..............................] - ETA: 26s 10/313 [..............................] - ETA: 26s 11/313 [>.............................] - ETA: 26s 12/313 [>.............................] - ETA: 26s 13/313 [>.............................] - ETA: 26s 14/313 [>.............................] - ETA: 26s 15/313 [>.............................] - ETA: 26s 16/313 [>.............................] - ETA: 25s 17/313 [>.............................] - ETA: 25s 18/313 [>.............................] - ETA: 25s 19/313 [>.............................] - ETA: 25s 20/313 [>.............................] - ETA: 25s 21/313 [=>............................] - ETA: 25s 22/313 [=>............................] - ETA: 25s 23/313 [=>............................] - ETA: 25s 24/313 [=>............................] - ETA: 25s 25/313 [=>............................] - ETA: 25s 26/313 [=>............................] - ETA: 25s 27/313 [=>............................] - ETA: 25s 28/313 [=>............................] - ETA: 24s 29/313 [=>............................] - ETA: 24s 30/313 [=>............................] - ETA: 24s 31/313 [=>............................] - ETA: 24s 32/313 [==>...........................] - ETA: 24s 33/313 [==>...........................] - ETA: 24s 34/313 [==>...........................] - ETA: 24s 35/313 [==>...........................] - ETA: 24s 36/313 [==>...........................] - ETA: 24s 37/313 [==>...........................] - ETA: 24s 38/313 [==>...........................] - ETA: 24s 39/313 [==>...........................] - ETA: 23s 40/313 [==>...........................] - ETA: 23s 41/313 [==>...........................] - ETA: 23s 42/313 [===>..........................] - ETA: 23s 43/313 [===>..........................] - ETA: 23s 44/313 [===>..........................] - ETA: 23s 45/313 [===>..........................] - ETA: 23s 46/313 [===>..........................] - ETA: 23s 47/313 [===>..........................] - ETA: 23s 48/313 [===>..........................] - ETA: 23s 49/313 [===>..........................] - ETA: 23s 50/313 [===>..........................] - ETA: 23s 51/313 [===>..........................] - ETA: 22s 52/313 [===>..........................] - ETA: 22s 53/313 [====>.........................] - ETA: 22s 54/313 [====>.........................] - ETA: 22s 55/313 [====>.........................] - ETA: 22s 56/313 [====>.........................] - ETA: 22s 57/313 [====>.........................] - ETA: 22s 58/313 [====>.........................] - ETA: 22s 59/313 [====>.........................] - ETA: 22s 60/313 [====>.........................] - ETA: 22s 61/313 [====>.........................] - ETA: 22s 62/313 [====>.........................] - ETA: 22s 63/313 [=====>........................] - ETA: 21s 64/313 [=====>........................] - ETA: 21s 65/313 [=====>........................] - ETA: 21s 66/313 [=====>........................] - ETA: 21s 67/313 [=====>........................] - ETA: 21s 68/313 [=====>........................] - ETA: 21s 69/313 [=====>........................] - ETA: 21s 70/313 [=====>........................] - ETA: 21s 71/313 [=====>........................] - ETA: 21s 72/313 [=====>........................] - ETA: 21s 73/313 [=====>........................] - ETA: 21s 74/313 [======>.......................] - ETA: 20s 75/313 [======>.......................] - ETA: 20s 76/313 [======>.......................] - ETA: 20s 77/313 [======>.......................] - ETA: 20s 78/313 [======>.......................] - ETA: 20s 79/313 [======>.......................] - ETA: 20s 80/313 [======>.......................] - ETA: 20s 81/313 [======>.......................] - ETA: 20s 82/313 [======>.......................] - ETA: 20s 83/313 [======>.......................] - ETA: 20s 84/313 [=======>......................] - ETA: 20s 85/313 [=======>......................] - ETA: 20s 86/313 [=======>......................] - ETA: 19s 87/313 [=======>......................] - ETA: 19s 88/313 [=======>......................] - ETA: 19s 89/313 [=======>......................] - ETA: 19s 90/313 [=======>......................] - ETA: 19s 91/313 [=======>......................] - ETA: 19s 92/313 [=======>......................] - ETA: 19s 93/313 [=======>......................] - ETA: 19s 94/313 [========>.....................] - ETA: 19s 95/313 [========>.....................] - ETA: 19s 96/313 [========>.....................] - ETA: 19s 97/313 [========>.....................] - ETA: 18s 98/313 [========>.....................] - ETA: 18s 99/313 [========>.....................] - ETA: 18s100/313 [========>.....................] - ETA: 18s101/313 [========>.....................] - ETA: 18s102/313 [========>.....................] - ETA: 18s103/313 [========>.....................] - ETA: 18s104/313 [========>.....................] - ETA: 18s105/313 [=========>....................] - ETA: 18s106/313 [=========>....................] - ETA: 18s107/313 [=========>....................] - ETA: 18s108/313 [=========>....................] - ETA: 18s109/313 [=========>....................] - ETA: 17s110/313 [=========>....................] - ETA: 17s111/313 [=========>....................] - ETA: 17s112/313 [=========>....................] - ETA: 17s113/313 [=========>....................] - ETA: 17s114/313 [=========>....................] - ETA: 17s115/313 [==========>...................] - ETA: 17s116/313 [==========>...................] - ETA: 17s117/313 [==========>...................] - ETA: 17s118/313 [==========>...................] - ETA: 17s119/313 [==========>...................] - ETA: 17s120/313 [==========>...................] - ETA: 16s121/313 [==========>...................] - ETA: 16s122/313 [==========>...................] - ETA: 16s123/313 [==========>...................] - ETA: 16s124/313 [==========>...................] - ETA: 16s125/313 [==========>...................] - ETA: 16s126/313 [===========>..................] - ETA: 16s127/313 [===========>..................] - ETA: 16s128/313 [===========>..................] - ETA: 16s129/313 [===========>..................] - ETA: 16s130/313 [===========>..................] - ETA: 16s131/313 [===========>..................] - ETA: 15s132/313 [===========>..................] - ETA: 15s133/313 [===========>..................] - ETA: 15s134/313 [===========>..................] - ETA: 15s135/313 [===========>..................] - ETA: 15s136/313 [============>.................] - ETA: 15s137/313 [============>.................] - ETA: 15s138/313 [============>.................] - ETA: 15s139/313 [============>.................] - ETA: 15s140/313 [============>.................] - ETA: 15s141/313 [============>.................] - ETA: 15s142/313 [============>.................] - ETA: 15s143/313 [============>.................] - ETA: 14s144/313 [============>.................] - ETA: 14s145/313 [============>.................] - ETA: 14s146/313 [============>.................] - ETA: 14s147/313 [=============>................] - ETA: 14s148/313 [=============>................] - ETA: 14s149/313 [=============>................] - ETA: 14s150/313 [=============>................] - ETA: 14s151/313 [=============>................] - ETA: 14s152/313 [=============>................] - ETA: 14s153/313 [=============>................] - ETA: 14s154/313 [=============>................] - ETA: 13s155/313 [=============>................] - ETA: 13s156/313 [=============>................] - ETA: 13s157/313 [==============>...............] - ETA: 13s158/313 [==============>...............] - ETA: 13s159/313 [==============>...............] - ETA: 13s160/313 [==============>...............] - ETA: 13s161/313 [==============>...............] - ETA: 13s162/313 [==============>...............] - ETA: 13s163/313 [==============>...............] - ETA: 13s164/313 [==============>...............] - ETA: 13s165/313 [==============>...............] - ETA: 13s166/313 [==============>...............] - ETA: 12s167/313 [===============>..............] - ETA: 12s168/313 [===============>..............] - ETA: 12s169/313 [===============>..............] - ETA: 12s170/313 [===============>..............] - ETA: 12s171/313 [===============>..............] - ETA: 12s172/313 [===============>..............] - ETA: 12s173/313 [===============>..............] - ETA: 12s174/313 [===============>..............] - ETA: 12s175/313 [===============>..............] - ETA: 12s176/313 [===============>..............] - ETA: 12s177/313 [===============>..............] - ETA: 11s178/313 [================>.............] - ETA: 11s179/313 [================>.............] - ETA: 11s180/313 [================>.............] - ETA: 11s181/313 [================>.............] - ETA: 11s182/313 [================>.............] - ETA: 11s183/313 [================>.............] - ETA: 11s184/313 [================>.............] - ETA: 11s185/313 [================>.............] - ETA: 11s186/313 [================>.............] - ETA: 11s187/313 [================>.............] - ETA: 11s188/313 [=================>............] - ETA: 11s189/313 [=================>............] - ETA: 10s190/313 [=================>............] - ETA: 10s191/313 [=================>............] - ETA: 10s192/313 [=================>............] - ETA: 10s193/313 [=================>............] - ETA: 10s194/313 [=================>............] - ETA: 10s195/313 [=================>............] - ETA: 10s196/313 [=================>............] - ETA: 10s197/313 [=================>............] - ETA: 10s198/313 [=================>............] - ETA: 10s199/313 [==================>...........] - ETA: 10s200/313 [==================>...........] - ETA: 9s 201/313 [==================>...........] - ETA: 9s202/313 [==================>...........] - ETA: 9s203/313 [==================>...........] - ETA: 9s204/313 [==================>...........] - ETA: 9s205/313 [==================>...........] - ETA: 9s206/313 [==================>...........] - ETA: 9s207/313 [==================>...........] - ETA: 9s208/313 [==================>...........] - ETA: 9s209/313 [===================>..........] - ETA: 9s210/313 [===================>..........] - ETA: 9s211/313 [===================>..........] - ETA: 8s212/313 [===================>..........] - ETA: 8s213/313 [===================>..........] - ETA: 8s214/313 [===================>..........] - ETA: 8s215/313 [===================>..........] - ETA: 8s216/313 [===================>..........] - ETA: 8s217/313 [===================>..........] - ETA: 8s218/313 [===================>..........] - ETA: 8s219/313 [===================>..........] - ETA: 8s220/313 [====================>.........] - ETA: 8s221/313 [====================>.........] - ETA: 8s222/313 [====================>.........] - ETA: 8s223/313 [====================>.........] - ETA: 7s224/313 [====================>.........] - ETA: 7s225/313 [====================>.........] - ETA: 7s226/313 [====================>.........] - ETA: 7s227/313 [====================>.........] - ETA: 7s228/313 [====================>.........] - ETA: 7s229/313 [====================>.........] - ETA: 7s230/313 [=====================>........] - ETA: 7s231/313 [=====================>........] - ETA: 7s232/313 [=====================>........] - ETA: 7s233/313 [=====================>........] - ETA: 7s234/313 [=====================>........] - ETA: 6s235/313 [=====================>........] - ETA: 6s236/313 [=====================>........] - ETA: 6s237/313 [=====================>........] - ETA: 6s238/313 [=====================>........] - ETA: 6s239/313 [=====================>........] - ETA: 6s240/313 [======================>.......] - ETA: 6s241/313 [======================>.......] - ETA: 6s242/313 [======================>.......] - ETA: 6s243/313 [======================>.......] - ETA: 6s244/313 [======================>.......] - ETA: 6s245/313 [======================>.......] - ETA: 5s246/313 [======================>.......] - ETA: 5s247/313 [======================>.......] - ETA: 5s248/313 [======================>.......] - ETA: 5s249/313 [======================>.......] - ETA: 5s250/313 [======================>.......] - ETA: 5s251/313 [=======================>......] - ETA: 5s252/313 [=======================>......] - ETA: 5s253/313 [=======================>......] - ETA: 5s254/313 [=======================>......] - ETA: 5s255/313 [=======================>......] - ETA: 5s256/313 [=======================>......] - ETA: 5s257/313 [=======================>......] - ETA: 4s258/313 [=======================>......] - ETA: 4s259/313 [=======================>......] - ETA: 4s260/313 [=======================>......] - ETA: 4s261/313 [========================>.....] - ETA: 4s262/313 [========================>.....] - ETA: 4s263/313 [========================>.....] - ETA: 4s264/313 [========================>.....] - ETA: 4s265/313 [========================>.....] - ETA: 4s266/313 [========================>.....] - ETA: 4s267/313 [========================>.....] - ETA: 4s268/313 [========================>.....] - ETA: 3s269/313 [========================>.....] - ETA: 3s270/313 [========================>.....] - ETA: 3s271/313 [========================>.....] - ETA: 3s272/313 [=========================>....] - ETA: 3s273/313 [=========================>....] - ETA: 3s274/313 [=========================>....] - ETA: 3s275/313 [=========================>....] - ETA: 3s276/313 [=========================>....] - ETA: 3s277/313 [=========================>....] - ETA: 3s278/313 [=========================>....] - ETA: 3s279/313 [=========================>....] - ETA: 2s280/313 [=========================>....] - ETA: 2s281/313 [=========================>....] - ETA: 2s282/313 [==========================>...] - ETA: 2s283/313 [==========================>...] - ETA: 2s284/313 [==========================>...] - ETA: 2s285/313 [==========================>...] - ETA: 2s286/313 [==========================>...] - ETA: 2s287/313 [==========================>...] - ETA: 2s288/313 [==========================>...] - ETA: 2s289/313 [==========================>...] - ETA: 2s290/313 [==========================>...] - ETA: 2s291/313 [==========================>...] - ETA: 1s292/313 [==========================>...] - ETA: 1s293/313 [===========================>..] - ETA: 1s294/313 [===========================>..] - ETA: 1s295/313 [===========================>..] - ETA: 1s296/313 [===========================>..] - ETA: 1s297/313 [===========================>..] - ETA: 1s298/313 [===========================>..] - ETA: 1s299/313 [===========================>..] - ETA: 1s300/313 [===========================>..] - ETA: 1s301/313 [===========================>..] - ETA: 1s302/313 [===========================>..] - ETA: 0s303/313 [============================>.] - ETA: 0s304/313 [============================>.] - ETA: 0s305/313 [============================>.] - ETA: 0s306/313 [============================>.] - ETA: 0s307/313 [============================>.] - ETA: 0s308/313 [============================>.] - ETA: 0s309/313 [============================>.] - ETA: 0s310/313 [============================>.] - ETA: 0s311/313 [============================>.] - ETA: 0s312/313 [============================>.] - ETA: 0s313/313 [==============================] - ETA: 0s313/313 [==============================] - 42s 88ms/step
[[911   5  24  11   5   1   3   6  24  10]
 [  5 954   0   3   2   2   2   1   4  27]
 [ 32   0 847  37  34  24  13   9   4   0]
 [  7   2  16 838  22  86  10   9   8   2]
 [  5   1  27  34 893  13   7  18   2   0]
 [  0   0  15  94  17 852   2  19   0   1]
 [  5   2  21  36  10   4 918   3   0   1]
 [  8   0  14  14  17  28   0 917   0   2]
 [ 43   5   4   5   1   0   1   1 930  10]
 [ 18  33   2   5   1   0   2   3  10 926]]
              precision    recall  f1-score   support

           0       0.88      0.91      0.90      1000
           1       0.95      0.95      0.95      1000
           2       0.87      0.85      0.86      1000
           3       0.78      0.84      0.81      1000
           4       0.89      0.89      0.89      1000
           5       0.84      0.85      0.85      1000
           6       0.96      0.92      0.94      1000
           7       0.93      0.92      0.92      1000
           8       0.95      0.93      0.94      1000
           9       0.95      0.93      0.94      1000

    accuracy                           0.90     10000
   macro avg       0.90      0.90      0.90     10000
weighted avg       0.90      0.90      0.90     10000




[[916   5  19   8   5   1   1   8  27  10]
 [  6 945   0   3   0   1   2   1   6  36]
 [ 38   0 850  34  32  25  10   7   4   0]
 [ 10   1  16 819  25  93  12  10   8   6]
 [  5   1  31  28 889  17   6  20   3   0]
 [  1   0  14  92  18 853   1  18   1   2]
 [  7   2  24  36  15   6 908   2   0   0]
 [  9   0  10  16  22  35   0 905   1   2]
 [ 44   5   4   5   1   0   1   0 931   9]
 [ 22  29   2   2   0   0   2   3  10 930]]
              precision    recall  f1-score   support

           0       0.87      0.92      0.89      1000
           1       0.96      0.94      0.95      1000
           2       0.88      0.85      0.86      1000
           3       0.79      0.82      0.80      1000
           4       0.88      0.89      0.89      1000
           5       0.83      0.85      0.84      1000
           6       0.96      0.91      0.93      1000
           7       0.93      0.91      0.92      1000
           8       0.94      0.93      0.94      1000
           9       0.93      0.93      0.93      1000

    accuracy                           0.89     10000
   macro avg       0.90      0.89      0.90     10000
weighted avg       0.90      0.89      0.90     10000




[[889   5  32   9   4   1   4  12  31  13]
 [  3 941   1   2   1   2   3   1   7  39]
 [ 25   0 871  29  30  24  12   5   3   1]
 [  6   2  23 817  22  95  10  14   7   4]
 [  4   1  33  22 890  18   8  21   3   0]
 [  0   0  19  85  15 856   2  21   0   2]
 [  3   1  22  30  12   5 924   2   0   1]
 [  7   1  15  13  18  35   0 908   1   2]
 [ 44   4   3   6   1   2   3   0 927  10]
 [ 15  26   2   1   0   0   4   5  10 937]]
              precision    recall  f1-score   support

           0       0.89      0.89      0.89      1000
           1       0.96      0.94      0.95      1000
           2       0.85      0.87      0.86      1000
           3       0.81      0.82      0.81      1000
           4       0.90      0.89      0.89      1000
           5       0.82      0.86      0.84      1000
           6       0.95      0.92      0.94      1000
           7       0.92      0.91      0.91      1000
           8       0.94      0.93      0.93      1000
           9       0.93      0.94      0.93      1000

    accuracy                           0.90     10000
   macro avg       0.90      0.90      0.90     10000
weighted avg       0.90      0.90      0.90     10000




[[912   5  22   9   4   1   2   8  26  11]
 [  4 946   0   2   1   2   3   1   7  34]
 [ 32   0 854  32  33  26  11   7   5   0]
 [  7   2  16 825  22  94  10  12   8   4]
 [  5   1  28  29 896  14   6  18   3   0]
 [  0   0  18  92  15 852   2  19   0   2]
 [  3   3  21  32  13   6 919   2   0   1]
 [  9   0  13  14  18  32   0 911   1   2]
 [ 43   6   4   4   1   2   1   0 930   9]
 [ 20  28   2   2   0   0   3   3  10 932]]
              precision    recall  f1-score   support

           0       0.88      0.91      0.90      1000
           1       0.95      0.95      0.95      1000
           2       0.87      0.85      0.86      1000
           3       0.79      0.82      0.81      1000
           4       0.89      0.90      0.89      1000
           5       0.83      0.85      0.84      1000
           6       0.96      0.92      0.94      1000
           7       0.93      0.91      0.92      1000
           8       0.94      0.93      0.93      1000
           9       0.94      0.93      0.93      1000

    accuracy                           0.90     10000
   macro avg       0.90      0.90      0.90     10000
weighted avg       0.90      0.90      0.90     10000




