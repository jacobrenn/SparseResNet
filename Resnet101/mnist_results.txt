INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1', '/job:localhost/replica:0/task:0/device:GPU:2', '/job:localhost/replica:0/task:0/device:GPU:3')
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
  1/313 [..............................] - ETA: 52:05  2/313 [..............................] - ETA: 28s    3/313 [..............................] - ETA: 27s  4/313 [..............................] - ETA: 25s  5/313 [..............................] - ETA: 23s  6/313 [..............................] - ETA: 21s  7/313 [..............................] - ETA: 20s  8/313 [..............................] - ETA: 20s  9/313 [..............................] - ETA: 19s 10/313 [..............................] - ETA: 19s 11/313 [>.............................] - ETA: 18s 12/313 [>.............................] - ETA: 18s 13/313 [>.............................] - ETA: 18s 14/313 [>.............................] - ETA: 17s 15/313 [>.............................] - ETA: 17s 16/313 [>.............................] - ETA: 17s 17/313 [>.............................] - ETA: 17s 18/313 [>.............................] - ETA: 17s 19/313 [>.............................] - ETA: 16s 20/313 [>.............................] - ETA: 16s 21/313 [=>............................] - ETA: 16s 22/313 [=>............................] - ETA: 16s 23/313 [=>............................] - ETA: 16s 24/313 [=>............................] - ETA: 16s 25/313 [=>............................] - ETA: 16s 26/313 [=>............................] - ETA: 16s 27/313 [=>............................] - ETA: 16s 28/313 [=>............................] - ETA: 15s 29/313 [=>............................] - ETA: 15s 30/313 [=>............................] - ETA: 15s 31/313 [=>............................] - ETA: 15s 32/313 [==>...........................] - ETA: 15s 33/313 [==>...........................] - ETA: 15s 34/313 [==>...........................] - ETA: 15s 35/313 [==>...........................] - ETA: 15s 36/313 [==>...........................] - ETA: 15s 37/313 [==>...........................] - ETA: 15s 38/313 [==>...........................] - ETA: 15s 39/313 [==>...........................] - ETA: 15s 40/313 [==>...........................] - ETA: 14s 41/313 [==>...........................] - ETA: 14s 42/313 [===>..........................] - ETA: 14s 43/313 [===>..........................] - ETA: 14s 44/313 [===>..........................] - ETA: 14s 45/313 [===>..........................] - ETA: 14s 46/313 [===>..........................] - ETA: 14s 47/313 [===>..........................] - ETA: 14s 48/313 [===>..........................] - ETA: 14s 49/313 [===>..........................] - ETA: 14s 50/313 [===>..........................] - ETA: 14s 51/313 [===>..........................] - ETA: 14s 52/313 [===>..........................] - ETA: 14s 53/313 [====>.........................] - ETA: 14s 54/313 [====>.........................] - ETA: 14s 55/313 [====>.........................] - ETA: 14s 56/313 [====>.........................] - ETA: 13s 57/313 [====>.........................] - ETA: 13s 58/313 [====>.........................] - ETA: 13s 59/313 [====>.........................] - ETA: 13s 60/313 [====>.........................] - ETA: 13s 61/313 [====>.........................] - ETA: 13s 62/313 [====>.........................] - ETA: 13s 63/313 [=====>........................] - ETA: 13s 64/313 [=====>........................] - ETA: 13s 65/313 [=====>........................] - ETA: 13s 66/313 [=====>........................] - ETA: 13s 67/313 [=====>........................] - ETA: 13s 68/313 [=====>........................] - ETA: 13s 69/313 [=====>........................] - ETA: 13s 70/313 [=====>........................] - ETA: 13s 71/313 [=====>........................] - ETA: 13s 72/313 [=====>........................] - ETA: 12s 73/313 [=====>........................] - ETA: 12s 74/313 [======>.......................] - ETA: 12s 75/313 [======>.......................] - ETA: 12s 76/313 [======>.......................] - ETA: 12s 77/313 [======>.......................] - ETA: 12s 78/313 [======>.......................] - ETA: 12s 79/313 [======>.......................] - ETA: 12s 80/313 [======>.......................] - ETA: 12s 81/313 [======>.......................] - ETA: 12s 82/313 [======>.......................] - ETA: 12s 83/313 [======>.......................] - ETA: 12s 84/313 [=======>......................] - ETA: 12s 85/313 [=======>......................] - ETA: 12s 86/313 [=======>......................] - ETA: 12s 87/313 [=======>......................] - ETA: 12s 88/313 [=======>......................] - ETA: 12s 89/313 [=======>......................] - ETA: 12s 90/313 [=======>......................] - ETA: 11s 91/313 [=======>......................] - ETA: 11s 92/313 [=======>......................] - ETA: 11s 93/313 [=======>......................] - ETA: 11s 94/313 [========>.....................] - ETA: 11s 95/313 [========>.....................] - ETA: 11s 96/313 [========>.....................] - ETA: 11s 97/313 [========>.....................] - ETA: 11s 98/313 [========>.....................] - ETA: 11s 99/313 [========>.....................] - ETA: 11s100/313 [========>.....................] - ETA: 11s101/313 [========>.....................] - ETA: 11s102/313 [========>.....................] - ETA: 11s103/313 [========>.....................] - ETA: 11s104/313 [========>.....................] - ETA: 11s105/313 [=========>....................] - ETA: 11s106/313 [=========>....................] - ETA: 11s107/313 [=========>....................] - ETA: 11s108/313 [=========>....................] - ETA: 10s109/313 [=========>....................] - ETA: 10s110/313 [=========>....................] - ETA: 10s111/313 [=========>....................] - ETA: 10s112/313 [=========>....................] - ETA: 10s113/313 [=========>....................] - ETA: 10s114/313 [=========>....................] - ETA: 10s115/313 [==========>...................] - ETA: 10s116/313 [==========>...................] - ETA: 10s117/313 [==========>...................] - ETA: 10s118/313 [==========>...................] - ETA: 10s119/313 [==========>...................] - ETA: 10s120/313 [==========>...................] - ETA: 10s121/313 [==========>...................] - ETA: 10s122/313 [==========>...................] - ETA: 10s123/313 [==========>...................] - ETA: 10s124/313 [==========>...................] - ETA: 10s125/313 [==========>...................] - ETA: 10s126/313 [===========>..................] - ETA: 9s 127/313 [===========>..................] - ETA: 9s128/313 [===========>..................] - ETA: 9s129/313 [===========>..................] - ETA: 9s130/313 [===========>..................] - ETA: 9s131/313 [===========>..................] - ETA: 9s132/313 [===========>..................] - ETA: 9s133/313 [===========>..................] - ETA: 9s134/313 [===========>..................] - ETA: 9s135/313 [===========>..................] - ETA: 9s136/313 [============>.................] - ETA: 9s137/313 [============>.................] - ETA: 9s138/313 [============>.................] - ETA: 9s139/313 [============>.................] - ETA: 9s140/313 [============>.................] - ETA: 9s141/313 [============>.................] - ETA: 9s142/313 [============>.................] - ETA: 9s143/313 [============>.................] - ETA: 9s144/313 [============>.................] - ETA: 9s145/313 [============>.................] - ETA: 8s146/313 [============>.................] - ETA: 8s147/313 [=============>................] - ETA: 8s148/313 [=============>................] - ETA: 8s149/313 [=============>................] - ETA: 8s150/313 [=============>................] - ETA: 8s151/313 [=============>................] - ETA: 8s152/313 [=============>................] - ETA: 8s153/313 [=============>................] - ETA: 8s154/313 [=============>................] - ETA: 8s155/313 [=============>................] - ETA: 8s156/313 [=============>................] - ETA: 8s157/313 [==============>...............] - ETA: 8s158/313 [==============>...............] - ETA: 8s159/313 [==============>...............] - ETA: 8s160/313 [==============>...............] - ETA: 8s161/313 [==============>...............] - ETA: 8s162/313 [==============>...............] - ETA: 8s163/313 [==============>...............] - ETA: 7s164/313 [==============>...............] - ETA: 7s165/313 [==============>...............] - ETA: 7s166/313 [==============>...............] - ETA: 7s167/313 [===============>..............] - ETA: 7s168/313 [===============>..............] - ETA: 7s169/313 [===============>..............] - ETA: 7s170/313 [===============>..............] - ETA: 7s171/313 [===============>..............] - ETA: 7s172/313 [===============>..............] - ETA: 7s173/313 [===============>..............] - ETA: 7s174/313 [===============>..............] - ETA: 7s175/313 [===============>..............] - ETA: 7s176/313 [===============>..............] - ETA: 7s177/313 [===============>..............] - ETA: 7s178/313 [================>.............] - ETA: 7s179/313 [================>.............] - ETA: 7s180/313 [================>.............] - ETA: 7s181/313 [================>.............] - ETA: 7s182/313 [================>.............] - ETA: 6s183/313 [================>.............] - ETA: 6s184/313 [================>.............] - ETA: 6s185/313 [================>.............] - ETA: 6s186/313 [================>.............] - ETA: 6s187/313 [================>.............] - ETA: 6s188/313 [=================>............] - ETA: 6s189/313 [=================>............] - ETA: 6s190/313 [=================>............] - ETA: 6s191/313 [=================>............] - ETA: 6s192/313 [=================>............] - ETA: 6s193/313 [=================>............] - ETA: 6s194/313 [=================>............] - ETA: 6s195/313 [=================>............] - ETA: 6s196/313 [=================>............] - ETA: 6s197/313 [=================>............] - ETA: 6s198/313 [=================>............] - ETA: 6s199/313 [==================>...........] - ETA: 6s200/313 [==================>...........] - ETA: 6s201/313 [==================>...........] - ETA: 5s202/313 [==================>...........] - ETA: 5s203/313 [==================>...........] - ETA: 5s204/313 [==================>...........] - ETA: 5s205/313 [==================>...........] - ETA: 5s206/313 [==================>...........] - ETA: 5s207/313 [==================>...........] - ETA: 5s208/313 [==================>...........] - ETA: 5s209/313 [===================>..........] - ETA: 5s210/313 [===================>..........] - ETA: 5s211/313 [===================>..........] - ETA: 5s212/313 [===================>..........] - ETA: 5s213/313 [===================>..........] - ETA: 5s214/313 [===================>..........] - ETA: 5s215/313 [===================>..........] - ETA: 5s216/313 [===================>..........] - ETA: 5s217/313 [===================>..........] - ETA: 5s218/313 [===================>..........] - ETA: 5s219/313 [===================>..........] - ETA: 4s220/313 [====================>.........] - ETA: 4s221/313 [====================>.........] - ETA: 4s222/313 [====================>.........] - ETA: 4s223/313 [====================>.........] - ETA: 4s224/313 [====================>.........] - ETA: 4s225/313 [====================>.........] - ETA: 4s226/313 [====================>.........] - ETA: 4s227/313 [====================>.........] - ETA: 4s228/313 [====================>.........] - ETA: 4s229/313 [====================>.........] - ETA: 4s230/313 [=====================>........] - ETA: 4s231/313 [=====================>........] - ETA: 4s232/313 [=====================>........] - ETA: 4s233/313 [=====================>........] - ETA: 4s234/313 [=====================>........] - ETA: 4s235/313 [=====================>........] - ETA: 4s236/313 [=====================>........] - ETA: 4s237/313 [=====================>........] - ETA: 4s238/313 [=====================>........] - ETA: 3s239/313 [=====================>........] - ETA: 3s240/313 [======================>.......] - ETA: 3s241/313 [======================>.......] - ETA: 3s242/313 [======================>.......] - ETA: 3s243/313 [======================>.......] - ETA: 3s244/313 [======================>.......] - ETA: 3s245/313 [======================>.......] - ETA: 3s246/313 [======================>.......] - ETA: 3s247/313 [======================>.......] - ETA: 3s248/313 [======================>.......] - ETA: 3s249/313 [======================>.......] - ETA: 3s250/313 [======================>.......] - ETA: 3s251/313 [=======================>......] - ETA: 3s252/313 [=======================>......] - ETA: 3s253/313 [=======================>......] - ETA: 3s254/313 [=======================>......] - ETA: 3s255/313 [=======================>......] - ETA: 3s256/313 [=======================>......] - ETA: 3s257/313 [=======================>......] - ETA: 2s258/313 [=======================>......] - ETA: 2s259/313 [=======================>......] - ETA: 2s260/313 [=======================>......] - ETA: 2s261/313 [========================>.....] - ETA: 2s262/313 [========================>.....] - ETA: 2s263/313 [========================>.....] - ETA: 2s264/313 [========================>.....] - ETA: 2s265/313 [========================>.....] - ETA: 2s266/313 [========================>.....] - ETA: 2s267/313 [========================>.....] - ETA: 2s268/313 [========================>.....] - ETA: 2s269/313 [========================>.....] - ETA: 2s270/313 [========================>.....] - ETA: 2s271/313 [========================>.....] - ETA: 2s272/313 [=========================>....] - ETA: 2s273/313 [=========================>....] - ETA: 2s274/313 [=========================>....] - ETA: 2s275/313 [=========================>....] - ETA: 2s276/313 [=========================>....] - ETA: 1s277/313 [=========================>....] - ETA: 1s278/313 [=========================>....] - ETA: 1s279/313 [=========================>....] - ETA: 1s280/313 [=========================>....] - ETA: 1s281/313 [=========================>....] - ETA: 1s282/313 [==========================>...] - ETA: 1s283/313 [==========================>...] - ETA: 1s284/313 [==========================>...] - ETA: 1s285/313 [==========================>...] - ETA: 1s286/313 [==========================>...] - ETA: 1s287/313 [==========================>...] - ETA: 1s288/313 [==========================>...] - ETA: 1s289/313 [==========================>...] - ETA: 1s290/313 [==========================>...] - ETA: 1s291/313 [==========================>...] - ETA: 1s292/313 [==========================>...] - ETA: 1s293/313 [===========================>..] - ETA: 1s294/313 [===========================>..] - ETA: 1s295/313 [===========================>..] - ETA: 0s296/313 [===========================>..] - ETA: 0s297/313 [===========================>..] - ETA: 0s298/313 [===========================>..] - ETA: 0s299/313 [===========================>..] - ETA: 0s300/313 [===========================>..] - ETA: 0s301/313 [===========================>..] - ETA: 0s302/313 [===========================>..] - ETA: 0s303/313 [============================>.] - ETA: 0s304/313 [============================>.] - ETA: 0s305/313 [============================>.] - ETA: 0s306/313 [============================>.] - ETA: 0s307/313 [============================>.] - ETA: 0s308/313 [============================>.] - ETA: 0s309/313 [============================>.] - ETA: 0s310/313 [============================>.] - ETA: 0s311/313 [============================>.] - ETA: 0s312/313 [============================>.] - ETA: 0s313/313 [==============================] - ETA: 0s313/313 [==============================] - 27s 54ms/step
[[ 978    0    0    1    0    0    1    0    0    0]
 [   0 1133    0    2    0    0    0    0    0    0]
 [   0    0 1025    0    0    0    0    7    0    0]
 [   0    0    1 1004    0    4    0    0    0    1]
 [   0    0    1    0  972    0    1    0    0    8]
 [   0    0    0    3    0  886    1    1    0    1]
 [   4    1    0    0    0    1  949    0    3    0]
 [   0    3    1    0    0    0    0 1024    0    0]
 [   0    0    0    0    0    1    0    1  969    3]
 [   1    1    0    0    3    0    0    4    0 1000]]
              precision    recall  f1-score   support

           0       0.99      1.00      1.00       980
           1       1.00      1.00      1.00      1135
           2       1.00      0.99      1.00      1032
           3       0.99      0.99      0.99      1010
           4       1.00      0.99      0.99       982
           5       0.99      0.99      0.99       892
           6       1.00      0.99      0.99       958
           7       0.99      1.00      0.99      1028
           8       1.00      0.99      1.00       974
           9       0.99      0.99      0.99      1009

    accuracy                           0.99     10000
   macro avg       0.99      0.99      0.99     10000
weighted avg       0.99      0.99      0.99     10000




[[ 977    0    0    1    0    0    2    0    0    0]
 [   0 1133    0    2    0    0    0    0    0    0]
 [   0    0 1019    0    0    0    1   12    0    0]
 [   0    0    0 1006    0    4    0    0    0    0]
 [   0    1    1    0  971    0    1    0    0    8]
 [   0    0    0    2    0  888    1    1    0    0]
 [   4    2    0    0    0    1  948    0    3    0]
 [   0    3    0    0    0    0    0 1025    0    0]
 [   1    0    1    0    1    3    0    1  964    3]
 [   1    0    0    0    3    0    0    6    0  999]]
              precision    recall  f1-score   support

           0       0.99      1.00      1.00       980
           1       0.99      1.00      1.00      1135
           2       1.00      0.99      0.99      1032
           3       1.00      1.00      1.00      1010
           4       1.00      0.99      0.99       982
           5       0.99      1.00      0.99       892
           6       0.99      0.99      0.99       958
           7       0.98      1.00      0.99      1028
           8       1.00      0.99      0.99       974
           9       0.99      0.99      0.99      1009

    accuracy                           0.99     10000
   macro avg       0.99      0.99      0.99     10000
weighted avg       0.99      0.99      0.99     10000




[[ 976    0    0    0    0    0    3    0    1    0]
 [   0 1133    0    2    0    0    0    0    0    0]
 [   0    0 1022    0    0    0    0   10    0    0]
 [   0    0    1 1007    0    2    0    0    0    0]
 [   0    1    0    0  972    0    1    0    0    8]
 [   0    0    0    2    0  887    1    1    0    1]
 [   3    2    2    0    0    2  947    0    2    0]
 [   0    3    0    0    0    0    0 1025    0    0]
 [   0    0    0    1    0    2    0    2  967    2]
 [   0    0    0    0    3    0    0    6    0 1000]]
              precision    recall  f1-score   support

           0       1.00      1.00      1.00       980
           1       0.99      1.00      1.00      1135
           2       1.00      0.99      0.99      1032
           3       1.00      1.00      1.00      1010
           4       1.00      0.99      0.99       982
           5       0.99      0.99      0.99       892
           6       0.99      0.99      0.99       958
           7       0.98      1.00      0.99      1028
           8       1.00      0.99      0.99       974
           9       0.99      0.99      0.99      1009

    accuracy                           0.99     10000
   macro avg       0.99      0.99      0.99     10000
weighted avg       0.99      0.99      0.99     10000




[[ 977    0    0    1    0    0    2    0    0    0]
 [   0 1133    0    2    0    0    0    0    0    0]
 [   0    0 1024    0    0    0    0    8    0    0]
 [   0    0    1 1005    0    4    0    0    0    0]
 [   0    1    0    0  972    0    1    0    0    8]
 [   0    0    0    2    0  888    1    1    0    0]
 [   4    2    0    0    0    1  948    0    3    0]
 [   0    3    0    0    0    0    0 1025    0    0]
 [   0    0    0    0    0    1    0    1  969    3]
 [   1    1    0    0    3    0    0    4    0 1000]]
              precision    recall  f1-score   support

           0       0.99      1.00      1.00       980
           1       0.99      1.00      1.00      1135
           2       1.00      0.99      1.00      1032
           3       1.00      1.00      1.00      1010
           4       1.00      0.99      0.99       982
           5       0.99      1.00      0.99       892
           6       1.00      0.99      0.99       958
           7       0.99      1.00      0.99      1028
           8       1.00      0.99      1.00       974
           9       0.99      0.99      0.99      1009

    accuracy                           0.99     10000
   macro avg       0.99      0.99      0.99     10000
weighted avg       0.99      0.99      0.99     10000




