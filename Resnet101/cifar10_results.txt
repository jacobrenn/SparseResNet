INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1', '/job:localhost/replica:0/task:0/device:GPU:2', '/job:localhost/replica:0/task:0/device:GPU:3')
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
  1/313 [..............................] - ETA: 54:41  2/313 [..............................] - ETA: 18s    3/313 [..............................] - ETA: 18s  4/313 [..............................] - ETA: 18s  5/313 [..............................] - ETA: 18s  6/313 [..............................] - ETA: 18s  7/313 [..............................] - ETA: 18s  8/313 [..............................] - ETA: 18s  9/313 [..............................] - ETA: 18s 10/313 [..............................] - ETA: 18s 11/313 [>.............................] - ETA: 18s 12/313 [>.............................] - ETA: 17s 13/313 [>.............................] - ETA: 17s 14/313 [>.............................] - ETA: 17s 15/313 [>.............................] - ETA: 17s 16/313 [>.............................] - ETA: 17s 17/313 [>.............................] - ETA: 17s 18/313 [>.............................] - ETA: 17s 19/313 [>.............................] - ETA: 17s 20/313 [>.............................] - ETA: 17s 21/313 [=>............................] - ETA: 17s 22/313 [=>............................] - ETA: 17s 23/313 [=>............................] - ETA: 17s 24/313 [=>............................] - ETA: 17s 25/313 [=>............................] - ETA: 17s 26/313 [=>............................] - ETA: 17s 27/313 [=>............................] - ETA: 17s 28/313 [=>............................] - ETA: 17s 29/313 [=>............................] - ETA: 17s 30/313 [=>............................] - ETA: 16s 31/313 [=>............................] - ETA: 16s 32/313 [==>...........................] - ETA: 16s 33/313 [==>...........................] - ETA: 16s 34/313 [==>...........................] - ETA: 16s 35/313 [==>...........................] - ETA: 16s 36/313 [==>...........................] - ETA: 16s 37/313 [==>...........................] - ETA: 16s 38/313 [==>...........................] - ETA: 16s 39/313 [==>...........................] - ETA: 16s 40/313 [==>...........................] - ETA: 16s 41/313 [==>...........................] - ETA: 16s 42/313 [===>..........................] - ETA: 16s 43/313 [===>..........................] - ETA: 16s 44/313 [===>..........................] - ETA: 16s 45/313 [===>..........................] - ETA: 16s 46/313 [===>..........................] - ETA: 15s 47/313 [===>..........................] - ETA: 15s 48/313 [===>..........................] - ETA: 15s 49/313 [===>..........................] - ETA: 15s 50/313 [===>..........................] - ETA: 15s 51/313 [===>..........................] - ETA: 15s 52/313 [===>..........................] - ETA: 15s 53/313 [====>.........................] - ETA: 15s 54/313 [====>.........................] - ETA: 15s 55/313 [====>.........................] - ETA: 15s 56/313 [====>.........................] - ETA: 15s 57/313 [====>.........................] - ETA: 15s 58/313 [====>.........................] - ETA: 15s 59/313 [====>.........................] - ETA: 15s 60/313 [====>.........................] - ETA: 15s 61/313 [====>.........................] - ETA: 15s 62/313 [====>.........................] - ETA: 15s 63/313 [=====>........................] - ETA: 14s 64/313 [=====>........................] - ETA: 14s 65/313 [=====>........................] - ETA: 14s 66/313 [=====>........................] - ETA: 14s 67/313 [=====>........................] - ETA: 14s 68/313 [=====>........................] - ETA: 14s 69/313 [=====>........................] - ETA: 14s 70/313 [=====>........................] - ETA: 14s 71/313 [=====>........................] - ETA: 14s 72/313 [=====>........................] - ETA: 14s 73/313 [=====>........................] - ETA: 14s 74/313 [======>.......................] - ETA: 14s 75/313 [======>.......................] - ETA: 14s 76/313 [======>.......................] - ETA: 14s 77/313 [======>.......................] - ETA: 14s 78/313 [======>.......................] - ETA: 14s 79/313 [======>.......................] - ETA: 13s 80/313 [======>.......................] - ETA: 13s 81/313 [======>.......................] - ETA: 13s 82/313 [======>.......................] - ETA: 13s 83/313 [======>.......................] - ETA: 13s 84/313 [=======>......................] - ETA: 13s 85/313 [=======>......................] - ETA: 13s 86/313 [=======>......................] - ETA: 13s 87/313 [=======>......................] - ETA: 13s 88/313 [=======>......................] - ETA: 13s 89/313 [=======>......................] - ETA: 13s 90/313 [=======>......................] - ETA: 13s 91/313 [=======>......................] - ETA: 13s 92/313 [=======>......................] - ETA: 13s 93/313 [=======>......................] - ETA: 13s 94/313 [========>.....................] - ETA: 13s 95/313 [========>.....................] - ETA: 13s 96/313 [========>.....................] - ETA: 12s 97/313 [========>.....................] - ETA: 12s 98/313 [========>.....................] - ETA: 12s 99/313 [========>.....................] - ETA: 12s100/313 [========>.....................] - ETA: 12s101/313 [========>.....................] - ETA: 12s102/313 [========>.....................] - ETA: 12s103/313 [========>.....................] - ETA: 12s104/313 [========>.....................] - ETA: 12s105/313 [=========>....................] - ETA: 12s106/313 [=========>....................] - ETA: 12s107/313 [=========>....................] - ETA: 12s108/313 [=========>....................] - ETA: 12s109/313 [=========>....................] - ETA: 12s110/313 [=========>....................] - ETA: 12s111/313 [=========>....................] - ETA: 12s112/313 [=========>....................] - ETA: 12s113/313 [=========>....................] - ETA: 11s114/313 [=========>....................] - ETA: 11s115/313 [==========>...................] - ETA: 11s116/313 [==========>...................] - ETA: 11s117/313 [==========>...................] - ETA: 11s118/313 [==========>...................] - ETA: 11s119/313 [==========>...................] - ETA: 11s120/313 [==========>...................] - ETA: 11s121/313 [==========>...................] - ETA: 11s122/313 [==========>...................] - ETA: 11s123/313 [==========>...................] - ETA: 11s124/313 [==========>...................] - ETA: 11s125/313 [==========>...................] - ETA: 11s126/313 [===========>..................] - ETA: 11s127/313 [===========>..................] - ETA: 11s128/313 [===========>..................] - ETA: 11s129/313 [===========>..................] - ETA: 11s130/313 [===========>..................] - ETA: 10s131/313 [===========>..................] - ETA: 10s132/313 [===========>..................] - ETA: 10s133/313 [===========>..................] - ETA: 10s134/313 [===========>..................] - ETA: 10s135/313 [===========>..................] - ETA: 10s136/313 [============>.................] - ETA: 10s137/313 [============>.................] - ETA: 10s138/313 [============>.................] - ETA: 10s139/313 [============>.................] - ETA: 10s140/313 [============>.................] - ETA: 10s141/313 [============>.................] - ETA: 10s142/313 [============>.................] - ETA: 10s143/313 [============>.................] - ETA: 10s144/313 [============>.................] - ETA: 10s145/313 [============>.................] - ETA: 10s146/313 [============>.................] - ETA: 10s147/313 [=============>................] - ETA: 9s 148/313 [=============>................] - ETA: 9s149/313 [=============>................] - ETA: 9s150/313 [=============>................] - ETA: 9s151/313 [=============>................] - ETA: 9s152/313 [=============>................] - ETA: 9s153/313 [=============>................] - ETA: 9s154/313 [=============>................] - ETA: 9s155/313 [=============>................] - ETA: 9s156/313 [=============>................] - ETA: 9s157/313 [==============>...............] - ETA: 9s158/313 [==============>...............] - ETA: 9s159/313 [==============>...............] - ETA: 9s160/313 [==============>...............] - ETA: 9s161/313 [==============>...............] - ETA: 9s162/313 [==============>...............] - ETA: 9s163/313 [==============>...............] - ETA: 8s164/313 [==============>...............] - ETA: 8s165/313 [==============>...............] - ETA: 8s166/313 [==============>...............] - ETA: 8s167/313 [===============>..............] - ETA: 8s168/313 [===============>..............] - ETA: 8s169/313 [===============>..............] - ETA: 8s170/313 [===============>..............] - ETA: 8s171/313 [===============>..............] - ETA: 8s172/313 [===============>..............] - ETA: 8s173/313 [===============>..............] - ETA: 8s174/313 [===============>..............] - ETA: 8s175/313 [===============>..............] - ETA: 8s176/313 [===============>..............] - ETA: 8s177/313 [===============>..............] - ETA: 8s178/313 [================>.............] - ETA: 8s179/313 [================>.............] - ETA: 8s180/313 [================>.............] - ETA: 7s181/313 [================>.............] - ETA: 7s182/313 [================>.............] - ETA: 7s183/313 [================>.............] - ETA: 7s184/313 [================>.............] - ETA: 7s185/313 [================>.............] - ETA: 7s186/313 [================>.............] - ETA: 7s187/313 [================>.............] - ETA: 7s188/313 [=================>............] - ETA: 7s189/313 [=================>............] - ETA: 7s190/313 [=================>............] - ETA: 7s191/313 [=================>............] - ETA: 7s192/313 [=================>............] - ETA: 7s193/313 [=================>............] - ETA: 7s194/313 [=================>............] - ETA: 7s195/313 [=================>............] - ETA: 7s196/313 [=================>............] - ETA: 7s197/313 [=================>............] - ETA: 6s198/313 [=================>............] - ETA: 6s199/313 [==================>...........] - ETA: 6s200/313 [==================>...........] - ETA: 6s201/313 [==================>...........] - ETA: 6s202/313 [==================>...........] - ETA: 6s203/313 [==================>...........] - ETA: 6s204/313 [==================>...........] - ETA: 6s205/313 [==================>...........] - ETA: 6s206/313 [==================>...........] - ETA: 6s207/313 [==================>...........] - ETA: 6s208/313 [==================>...........] - ETA: 6s209/313 [===================>..........] - ETA: 6s210/313 [===================>..........] - ETA: 6s211/313 [===================>..........] - ETA: 6s212/313 [===================>..........] - ETA: 6s213/313 [===================>..........] - ETA: 5s214/313 [===================>..........] - ETA: 5s215/313 [===================>..........] - ETA: 5s216/313 [===================>..........] - ETA: 5s217/313 [===================>..........] - ETA: 5s218/313 [===================>..........] - ETA: 5s219/313 [===================>..........] - ETA: 5s220/313 [====================>.........] - ETA: 5s221/313 [====================>.........] - ETA: 5s222/313 [====================>.........] - ETA: 5s223/313 [====================>.........] - ETA: 5s224/313 [====================>.........] - ETA: 5s225/313 [====================>.........] - ETA: 5s226/313 [====================>.........] - ETA: 5s227/313 [====================>.........] - ETA: 5s228/313 [====================>.........] - ETA: 5s229/313 [====================>.........] - ETA: 5s230/313 [=====================>........] - ETA: 4s231/313 [=====================>........] - ETA: 4s232/313 [=====================>........] - ETA: 4s233/313 [=====================>........] - ETA: 4s234/313 [=====================>........] - ETA: 4s235/313 [=====================>........] - ETA: 4s236/313 [=====================>........] - ETA: 4s237/313 [=====================>........] - ETA: 4s238/313 [=====================>........] - ETA: 4s239/313 [=====================>........] - ETA: 4s240/313 [======================>.......] - ETA: 4s241/313 [======================>.......] - ETA: 4s242/313 [======================>.......] - ETA: 4s243/313 [======================>.......] - ETA: 4s244/313 [======================>.......] - ETA: 4s245/313 [======================>.......] - ETA: 4s246/313 [======================>.......] - ETA: 4s247/313 [======================>.......] - ETA: 3s248/313 [======================>.......] - ETA: 3s249/313 [======================>.......] - ETA: 3s250/313 [======================>.......] - ETA: 3s251/313 [=======================>......] - ETA: 3s252/313 [=======================>......] - ETA: 3s253/313 [=======================>......] - ETA: 3s254/313 [=======================>......] - ETA: 3s255/313 [=======================>......] - ETA: 3s256/313 [=======================>......] - ETA: 3s257/313 [=======================>......] - ETA: 3s258/313 [=======================>......] - ETA: 3s259/313 [=======================>......] - ETA: 3s260/313 [=======================>......] - ETA: 3s261/313 [========================>.....] - ETA: 3s262/313 [========================>.....] - ETA: 3s263/313 [========================>.....] - ETA: 3s264/313 [========================>.....] - ETA: 2s265/313 [========================>.....] - ETA: 2s266/313 [========================>.....] - ETA: 2s267/313 [========================>.....] - ETA: 2s268/313 [========================>.....] - ETA: 2s269/313 [========================>.....] - ETA: 2s270/313 [========================>.....] - ETA: 2s271/313 [========================>.....] - ETA: 2s272/313 [=========================>....] - ETA: 2s273/313 [=========================>....] - ETA: 2s274/313 [=========================>....] - ETA: 2s275/313 [=========================>....] - ETA: 2s276/313 [=========================>....] - ETA: 2s277/313 [=========================>....] - ETA: 2s278/313 [=========================>....] - ETA: 2s279/313 [=========================>....] - ETA: 2s280/313 [=========================>....] - ETA: 1s281/313 [=========================>....] - ETA: 1s282/313 [==========================>...] - ETA: 1s283/313 [==========================>...] - ETA: 1s284/313 [==========================>...] - ETA: 1s285/313 [==========================>...] - ETA: 1s286/313 [==========================>...] - ETA: 1s287/313 [==========================>...] - ETA: 1s288/313 [==========================>...] - ETA: 1s289/313 [==========================>...] - ETA: 1s290/313 [==========================>...] - ETA: 1s291/313 [==========================>...] - ETA: 1s292/313 [==========================>...] - ETA: 1s293/313 [===========================>..] - ETA: 1s294/313 [===========================>..] - ETA: 1s295/313 [===========================>..] - ETA: 1s296/313 [===========================>..] - ETA: 1s297/313 [===========================>..] - ETA: 0s298/313 [===========================>..] - ETA: 0s299/313 [===========================>..] - ETA: 0s300/313 [===========================>..] - ETA: 0s301/313 [===========================>..] - ETA: 0s302/313 [===========================>..] - ETA: 0s303/313 [============================>.] - ETA: 0s304/313 [============================>.] - ETA: 0s305/313 [============================>.] - ETA: 0s306/313 [============================>.] - ETA: 0s307/313 [============================>.] - ETA: 0s308/313 [============================>.] - ETA: 0s309/313 [============================>.] - ETA: 0s310/313 [============================>.] - ETA: 0s311/313 [============================>.] - ETA: 0s312/313 [============================>.] - ETA: 0s313/313 [==============================] - 29s 60ms/step
[[931   7  10   3   4   0   2  11  27   5]
 [  5 957   0   0   0   0   0   0   9  29]
 [ 21   0 873  28  23  20  25   8   2   0]
 [ 13   3  21 853  23  51  22   6   6   2]
 [  4   1  21  23 918  12  10   9   2   0]
 [  4   0  15 103  21 834   3  18   1   1]
 [  6   0  21  21   8   5 932   5   1   1]
 [ 10   0  12  13  21  19   2 922   0   1]
 [ 35   5   4   3   1   0   2   1 936  13]
 [  8  32   1   4   0   0   0   1   9 945]]
              precision    recall  f1-score   support

           0       0.90      0.93      0.91      1000
           1       0.95      0.96      0.95      1000
           2       0.89      0.87      0.88      1000
           3       0.81      0.85      0.83      1000
           4       0.90      0.92      0.91      1000
           5       0.89      0.83      0.86      1000
           6       0.93      0.93      0.93      1000
           7       0.94      0.92      0.93      1000
           8       0.94      0.94      0.94      1000
           9       0.95      0.94      0.95      1000

    accuracy                           0.91     10000
   macro avg       0.91      0.91      0.91     10000
weighted avg       0.91      0.91      0.91     10000




[[929   5  13   4   5   0   1   9  27   7]
 [  4 953   1   2   0   0   1   0  12  27]
 [ 24   0 876  30  20  18  22   8   2   0]
 [ 13   3  27 849  25  50  19   5   6   3]
 [  5   0  24  21 911  15  11  11   2   0]
 [  4   0  10 106  16 840   5  17   2   0]
 [  6   0  19  21  13   3 932   3   2   1]
 [  9   0  12  15  26  26   1 909   0   2]
 [ 37   6   4   3   2   0   2   1 936   9]
 [ 10  29   1   4   0   0   0   1  12 943]]
              precision    recall  f1-score   support

           0       0.89      0.93      0.91      1000
           1       0.96      0.95      0.95      1000
           2       0.89      0.88      0.88      1000
           3       0.80      0.85      0.83      1000
           4       0.89      0.91      0.90      1000
           5       0.88      0.84      0.86      1000
           6       0.94      0.93      0.93      1000
           7       0.94      0.91      0.93      1000
           8       0.94      0.94      0.94      1000
           9       0.95      0.94      0.95      1000

    accuracy                           0.91     10000
   macro avg       0.91      0.91      0.91     10000
weighted avg       0.91      0.91      0.91     10000




[[899   5  31   6   5   0   1   9  37   7]
 [  5 953   1   1   0   0   1   0  12  27]
 [ 16   0 898  31  13  16  19   5   2   0]
 [ 11   2  38 859  13  48  17   3   7   2]
 [  3   1  34  33 893  12  10  11   3   0]
 [  3   0  22 132  14 811   3  13   2   0]
 [  4   0  27  24  11   3 924   3   3   1]
 [ 10   0  18  19  34  24   4 891   0   0]
 [ 30   6   6   3   1   0   2   0 943   9]
 [  7  34   2   6   0   0   0   1  12 938]]
              precision    recall  f1-score   support

           0       0.91      0.90      0.90      1000
           1       0.95      0.95      0.95      1000
           2       0.83      0.90      0.86      1000
           3       0.77      0.86      0.81      1000
           4       0.91      0.89      0.90      1000
           5       0.89      0.81      0.85      1000
           6       0.94      0.92      0.93      1000
           7       0.95      0.89      0.92      1000
           8       0.92      0.94      0.93      1000
           9       0.95      0.94      0.95      1000

    accuracy                           0.90     10000
   macro avg       0.90      0.90      0.90     10000
weighted avg       0.90      0.90      0.90     10000




[[919   5  18   5   4   0   1   9  33   6]
 [  5 957   1   0   0   0   0   0  11  26]
 [ 20   0 880  29  19  20  23   7   2   0]
 [ 12   2  28 856  21  50  19   4   6   2]
 [  5   1  24  24 909  12  11  12   2   0]
 [  4   0  15 112  17 832   3  15   2   0]
 [  6   0  23  21  11   3 929   4   2   1]
 [ 10   0  13  14  28  21   2 911   0   1]
 [ 34   6   4   3   2   0   2   0 938  11]
 [  7  32   1   3   0   0   0   1  10 946]]
              precision    recall  f1-score   support

           0       0.90      0.92      0.91      1000
           1       0.95      0.96      0.96      1000
           2       0.87      0.88      0.88      1000
           3       0.80      0.86      0.83      1000
           4       0.90      0.91      0.90      1000
           5       0.89      0.83      0.86      1000
           6       0.94      0.93      0.93      1000
           7       0.95      0.91      0.93      1000
           8       0.93      0.94      0.94      1000
           9       0.95      0.95      0.95      1000

    accuracy                           0.91     10000
   macro avg       0.91      0.91      0.91     10000
weighted avg       0.91      0.91      0.91     10000




