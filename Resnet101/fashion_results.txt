INFO:tensorflow:Using MirroredStrategy with devices ('/job:localhost/replica:0/task:0/device:GPU:0', '/job:localhost/replica:0/task:0/device:GPU:1', '/job:localhost/replica:0/task:0/device:GPU:2', '/job:localhost/replica:0/task:0/device:GPU:3')
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:Reduce to /job:localhost/replica:0/task:0/device:CPU:0 then broadcast to ('/job:localhost/replica:0/task:0/device:CPU:0',).
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
INFO:tensorflow:batch_all_reduce: 436 all-reduces with algorithm = nccl, num_packs = 1
  1/313 [..............................] - ETA: 52:22  2/313 [..............................] - ETA: 28s    3/313 [..............................] - ETA: 27s  4/313 [..............................] - ETA: 25s  5/313 [..............................] - ETA: 23s  6/313 [..............................] - ETA: 21s  7/313 [..............................] - ETA: 20s  8/313 [..............................] - ETA: 20s  9/313 [..............................] - ETA: 19s 10/313 [..............................] - ETA: 18s 11/313 [>.............................] - ETA: 18s 12/313 [>.............................] - ETA: 18s 13/313 [>.............................] - ETA: 17s 14/313 [>.............................] - ETA: 17s 15/313 [>.............................] - ETA: 17s 16/313 [>.............................] - ETA: 17s 17/313 [>.............................] - ETA: 17s 18/313 [>.............................] - ETA: 16s 19/313 [>.............................] - ETA: 16s 20/313 [>.............................] - ETA: 16s 21/313 [=>............................] - ETA: 16s 22/313 [=>............................] - ETA: 16s 23/313 [=>............................] - ETA: 16s 24/313 [=>............................] - ETA: 16s 25/313 [=>............................] - ETA: 16s 26/313 [=>............................] - ETA: 15s 27/313 [=>............................] - ETA: 15s 28/313 [=>............................] - ETA: 15s 29/313 [=>............................] - ETA: 15s 30/313 [=>............................] - ETA: 15s 31/313 [=>............................] - ETA: 15s 32/313 [==>...........................] - ETA: 15s 33/313 [==>...........................] - ETA: 15s 34/313 [==>...........................] - ETA: 15s 35/313 [==>...........................] - ETA: 15s 36/313 [==>...........................] - ETA: 15s 37/313 [==>...........................] - ETA: 15s 38/313 [==>...........................] - ETA: 14s 39/313 [==>...........................] - ETA: 14s 40/313 [==>...........................] - ETA: 14s 41/313 [==>...........................] - ETA: 14s 42/313 [===>..........................] - ETA: 14s 43/313 [===>..........................] - ETA: 14s 44/313 [===>..........................] - ETA: 14s 45/313 [===>..........................] - ETA: 14s 46/313 [===>..........................] - ETA: 14s 47/313 [===>..........................] - ETA: 14s 48/313 [===>..........................] - ETA: 14s 49/313 [===>..........................] - ETA: 14s 50/313 [===>..........................] - ETA: 14s 51/313 [===>..........................] - ETA: 14s 52/313 [===>..........................] - ETA: 13s 53/313 [====>.........................] - ETA: 13s 54/313 [====>.........................] - ETA: 13s 55/313 [====>.........................] - ETA: 13s 56/313 [====>.........................] - ETA: 13s 57/313 [====>.........................] - ETA: 13s 58/313 [====>.........................] - ETA: 13s 59/313 [====>.........................] - ETA: 13s 60/313 [====>.........................] - ETA: 13s 61/313 [====>.........................] - ETA: 13s 62/313 [====>.........................] - ETA: 13s 63/313 [=====>........................] - ETA: 13s 64/313 [=====>........................] - ETA: 13s 65/313 [=====>........................] - ETA: 13s 66/313 [=====>........................] - ETA: 13s 67/313 [=====>........................] - ETA: 13s 68/313 [=====>........................] - ETA: 12s 69/313 [=====>........................] - ETA: 12s 70/313 [=====>........................] - ETA: 12s 71/313 [=====>........................] - ETA: 12s 72/313 [=====>........................] - ETA: 12s 73/313 [=====>........................] - ETA: 12s 74/313 [======>.......................] - ETA: 12s 75/313 [======>.......................] - ETA: 12s 76/313 [======>.......................] - ETA: 12s 77/313 [======>.......................] - ETA: 12s 78/313 [======>.......................] - ETA: 12s 79/313 [======>.......................] - ETA: 12s 80/313 [======>.......................] - ETA: 12s 81/313 [======>.......................] - ETA: 12s 82/313 [======>.......................] - ETA: 12s 83/313 [======>.......................] - ETA: 12s 84/313 [=======>......................] - ETA: 12s 85/313 [=======>......................] - ETA: 12s 86/313 [=======>......................] - ETA: 11s 87/313 [=======>......................] - ETA: 11s 88/313 [=======>......................] - ETA: 11s 89/313 [=======>......................] - ETA: 11s 90/313 [=======>......................] - ETA: 11s 91/313 [=======>......................] - ETA: 11s 92/313 [=======>......................] - ETA: 11s 93/313 [=======>......................] - ETA: 11s 94/313 [========>.....................] - ETA: 11s 95/313 [========>.....................] - ETA: 11s 96/313 [========>.....................] - ETA: 11s 97/313 [========>.....................] - ETA: 11s 98/313 [========>.....................] - ETA: 11s 99/313 [========>.....................] - ETA: 11s100/313 [========>.....................] - ETA: 11s101/313 [========>.....................] - ETA: 11s102/313 [========>.....................] - ETA: 11s103/313 [========>.....................] - ETA: 11s104/313 [========>.....................] - ETA: 10s105/313 [=========>....................] - ETA: 10s106/313 [=========>....................] - ETA: 10s107/313 [=========>....................] - ETA: 10s108/313 [=========>....................] - ETA: 10s109/313 [=========>....................] - ETA: 10s110/313 [=========>....................] - ETA: 10s111/313 [=========>....................] - ETA: 10s112/313 [=========>....................] - ETA: 10s113/313 [=========>....................] - ETA: 10s114/313 [=========>....................] - ETA: 10s115/313 [==========>...................] - ETA: 10s116/313 [==========>...................] - ETA: 10s117/313 [==========>...................] - ETA: 10s118/313 [==========>...................] - ETA: 10s119/313 [==========>...................] - ETA: 10s120/313 [==========>...................] - ETA: 10s121/313 [==========>...................] - ETA: 10s122/313 [==========>...................] - ETA: 9s 123/313 [==========>...................] - ETA: 9s124/313 [==========>...................] - ETA: 9s125/313 [==========>...................] - ETA: 9s126/313 [===========>..................] - ETA: 9s127/313 [===========>..................] - ETA: 9s128/313 [===========>..................] - ETA: 9s129/313 [===========>..................] - ETA: 9s130/313 [===========>..................] - ETA: 9s131/313 [===========>..................] - ETA: 9s132/313 [===========>..................] - ETA: 9s133/313 [===========>..................] - ETA: 9s134/313 [===========>..................] - ETA: 9s135/313 [===========>..................] - ETA: 9s136/313 [============>.................] - ETA: 9s137/313 [============>.................] - ETA: 9s138/313 [============>.................] - ETA: 9s139/313 [============>.................] - ETA: 9s140/313 [============>.................] - ETA: 9s141/313 [============>.................] - ETA: 8s142/313 [============>.................] - ETA: 8s143/313 [============>.................] - ETA: 8s144/313 [============>.................] - ETA: 8s145/313 [============>.................] - ETA: 8s146/313 [============>.................] - ETA: 8s147/313 [=============>................] - ETA: 8s148/313 [=============>................] - ETA: 8s149/313 [=============>................] - ETA: 8s150/313 [=============>................] - ETA: 8s151/313 [=============>................] - ETA: 8s152/313 [=============>................] - ETA: 8s153/313 [=============>................] - ETA: 8s154/313 [=============>................] - ETA: 8s155/313 [=============>................] - ETA: 8s156/313 [=============>................] - ETA: 8s157/313 [==============>...............] - ETA: 8s158/313 [==============>...............] - ETA: 8s159/313 [==============>...............] - ETA: 8s160/313 [==============>...............] - ETA: 7s161/313 [==============>...............] - ETA: 7s162/313 [==============>...............] - ETA: 7s163/313 [==============>...............] - ETA: 7s164/313 [==============>...............] - ETA: 7s165/313 [==============>...............] - ETA: 7s166/313 [==============>...............] - ETA: 7s167/313 [===============>..............] - ETA: 7s168/313 [===============>..............] - ETA: 7s169/313 [===============>..............] - ETA: 7s170/313 [===============>..............] - ETA: 7s171/313 [===============>..............] - ETA: 7s172/313 [===============>..............] - ETA: 7s173/313 [===============>..............] - ETA: 7s174/313 [===============>..............] - ETA: 7s175/313 [===============>..............] - ETA: 7s176/313 [===============>..............] - ETA: 7s177/313 [===============>..............] - ETA: 7s178/313 [================>.............] - ETA: 7s179/313 [================>.............] - ETA: 6s180/313 [================>.............] - ETA: 6s181/313 [================>.............] - ETA: 6s182/313 [================>.............] - ETA: 6s183/313 [================>.............] - ETA: 6s184/313 [================>.............] - ETA: 6s185/313 [================>.............] - ETA: 6s186/313 [================>.............] - ETA: 6s187/313 [================>.............] - ETA: 6s188/313 [=================>............] - ETA: 6s189/313 [=================>............] - ETA: 6s190/313 [=================>............] - ETA: 6s191/313 [=================>............] - ETA: 6s192/313 [=================>............] - ETA: 6s193/313 [=================>............] - ETA: 6s194/313 [=================>............] - ETA: 6s195/313 [=================>............] - ETA: 6s196/313 [=================>............] - ETA: 6s197/313 [=================>............] - ETA: 6s198/313 [=================>............] - ETA: 5s199/313 [==================>...........] - ETA: 5s200/313 [==================>...........] - ETA: 5s201/313 [==================>...........] - ETA: 5s202/313 [==================>...........] - ETA: 5s203/313 [==================>...........] - ETA: 5s204/313 [==================>...........] - ETA: 5s205/313 [==================>...........] - ETA: 5s206/313 [==================>...........] - ETA: 5s207/313 [==================>...........] - ETA: 5s208/313 [==================>...........] - ETA: 5s209/313 [===================>..........] - ETA: 5s210/313 [===================>..........] - ETA: 5s211/313 [===================>..........] - ETA: 5s212/313 [===================>..........] - ETA: 5s213/313 [===================>..........] - ETA: 5s214/313 [===================>..........] - ETA: 5s215/313 [===================>..........] - ETA: 5s216/313 [===================>..........] - ETA: 5s217/313 [===================>..........] - ETA: 5s218/313 [===================>..........] - ETA: 4s219/313 [===================>..........] - ETA: 4s220/313 [====================>.........] - ETA: 4s221/313 [====================>.........] - ETA: 4s222/313 [====================>.........] - ETA: 4s223/313 [====================>.........] - ETA: 4s224/313 [====================>.........] - ETA: 4s225/313 [====================>.........] - ETA: 4s226/313 [====================>.........] - ETA: 4s227/313 [====================>.........] - ETA: 4s228/313 [====================>.........] - ETA: 4s229/313 [====================>.........] - ETA: 4s230/313 [=====================>........] - ETA: 4s231/313 [=====================>........] - ETA: 4s232/313 [=====================>........] - ETA: 4s233/313 [=====================>........] - ETA: 4s234/313 [=====================>........] - ETA: 4s235/313 [=====================>........] - ETA: 4s236/313 [=====================>........] - ETA: 4s237/313 [=====================>........] - ETA: 3s238/313 [=====================>........] - ETA: 3s239/313 [=====================>........] - ETA: 3s240/313 [======================>.......] - ETA: 3s241/313 [======================>.......] - ETA: 3s242/313 [======================>.......] - ETA: 3s243/313 [======================>.......] - ETA: 3s244/313 [======================>.......] - ETA: 3s245/313 [======================>.......] - ETA: 3s246/313 [======================>.......] - ETA: 3s247/313 [======================>.......] - ETA: 3s248/313 [======================>.......] - ETA: 3s249/313 [======================>.......] - ETA: 3s250/313 [======================>.......] - ETA: 3s251/313 [=======================>......] - ETA: 3s252/313 [=======================>......] - ETA: 3s253/313 [=======================>......] - ETA: 3s254/313 [=======================>......] - ETA: 3s255/313 [=======================>......] - ETA: 3s256/313 [=======================>......] - ETA: 2s257/313 [=======================>......] - ETA: 2s258/313 [=======================>......] - ETA: 2s259/313 [=======================>......] - ETA: 2s260/313 [=======================>......] - ETA: 2s261/313 [========================>.....] - ETA: 2s262/313 [========================>.....] - ETA: 2s263/313 [========================>.....] - ETA: 2s264/313 [========================>.....] - ETA: 2s265/313 [========================>.....] - ETA: 2s266/313 [========================>.....] - ETA: 2s267/313 [========================>.....] - ETA: 2s268/313 [========================>.....] - ETA: 2s269/313 [========================>.....] - ETA: 2s270/313 [========================>.....] - ETA: 2s271/313 [========================>.....] - ETA: 2s272/313 [=========================>....] - ETA: 2s273/313 [=========================>....] - ETA: 2s274/313 [=========================>....] - ETA: 2s275/313 [=========================>....] - ETA: 1s276/313 [=========================>....] - ETA: 1s277/313 [=========================>....] - ETA: 1s278/313 [=========================>....] - ETA: 1s279/313 [=========================>....] - ETA: 1s280/313 [=========================>....] - ETA: 1s281/313 [=========================>....] - ETA: 1s282/313 [==========================>...] - ETA: 1s283/313 [==========================>...] - ETA: 1s284/313 [==========================>...] - ETA: 1s285/313 [==========================>...] - ETA: 1s286/313 [==========================>...] - ETA: 1s287/313 [==========================>...] - ETA: 1s288/313 [==========================>...] - ETA: 1s289/313 [==========================>...] - ETA: 1s290/313 [==========================>...] - ETA: 1s291/313 [==========================>...] - ETA: 1s292/313 [==========================>...] - ETA: 1s293/313 [===========================>..] - ETA: 1s294/313 [===========================>..] - ETA: 0s295/313 [===========================>..] - ETA: 0s296/313 [===========================>..] - ETA: 0s297/313 [===========================>..] - ETA: 0s298/313 [===========================>..] - ETA: 0s299/313 [===========================>..] - ETA: 0s300/313 [===========================>..] - ETA: 0s301/313 [===========================>..] - ETA: 0s302/313 [===========================>..] - ETA: 0s303/313 [============================>.] - ETA: 0s304/313 [============================>.] - ETA: 0s305/313 [============================>.] - ETA: 0s306/313 [============================>.] - ETA: 0s307/313 [============================>.] - ETA: 0s308/313 [============================>.] - ETA: 0s309/313 [============================>.] - ETA: 0s310/313 [============================>.] - ETA: 0s311/313 [============================>.] - ETA: 0s312/313 [============================>.] - ETA: 0s313/313 [==============================] - ETA: 0s313/313 [==============================] - 27s 53ms/step
[[896   0  13   9   0   0  80   0   2   0]
 [  2 990   0   5   1   0   1   0   1   0]
 [ 16   1 912   8  24   0  39   0   0   0]
 [ 15   2   4 926  15   0  38   0   0   0]
 [  1   0  22  15 923   0  39   0   0   0]
 [  0   0   0   0   0 988   0   8   0   4]
 [ 90   2  41  18  41   0 805   0   3   0]
 [  0   0   0   0   0   1   0 986   0  13]
 [  4   1   2   1   2   2   0   0 986   2]
 [  1   0   0   0   0   4   0  34   0 961]]
              precision    recall  f1-score   support

           0       0.87      0.90      0.88      1000
           1       0.99      0.99      0.99      1000
           2       0.92      0.91      0.91      1000
           3       0.94      0.93      0.93      1000
           4       0.92      0.92      0.92      1000
           5       0.99      0.99      0.99      1000
           6       0.80      0.81      0.80      1000
           7       0.96      0.99      0.97      1000
           8       0.99      0.99      0.99      1000
           9       0.98      0.96      0.97      1000

    accuracy                           0.94     10000
   macro avg       0.94      0.94      0.94     10000
weighted avg       0.94      0.94      0.94     10000




[[881   0  18  12   0   0  88   0   1   0]
 [  1 989   0   8   0   0   1   0   1   0]
 [ 11   1 915   9  24   0  40   0   0   0]
 [ 14   2   5 931  13   0  35   0   0   0]
 [  2   0  23  15 918   0  42   0   0   0]
 [  0   0   0   0   0 986   0  10   0   4]
 [ 89   2  42  18  42   0 804   0   3   0]
 [  0   0   0   0   0   1   0 989   0  10]
 [  2   0   2   2   1   2   4   0 985   2]
 [  1   0   0   0   0   4   0  43   0 952]]
              precision    recall  f1-score   support

           0       0.88      0.88      0.88      1000
           1       0.99      0.99      0.99      1000
           2       0.91      0.92      0.91      1000
           3       0.94      0.93      0.93      1000
           4       0.92      0.92      0.92      1000
           5       0.99      0.99      0.99      1000
           6       0.79      0.80      0.80      1000
           7       0.95      0.99      0.97      1000
           8       0.99      0.98      0.99      1000
           9       0.98      0.95      0.97      1000

    accuracy                           0.94     10000
   macro avg       0.94      0.93      0.94     10000
weighted avg       0.94      0.94      0.94     10000




[[879   0  12  13   1   1  92   0   2   0]
 [  0 990   0   8   0   0   1   0   1   0]
 [ 16   1 897  11  35   0  39   0   1   0]
 [  8   2   3 941  17   0  29   0   0   0]
 [  1   1  21  16 931   0  30   0   0   0]
 [  0   0   0   0   0 989   0   7   0   4]
 [ 77   2  37  20  56   0 805   0   3   0]
 [  0   0   0   0   0   6   0 983   0  11]
 [  4   1   2   0   3   2   3   0 983   2]
 [  1   0   0   0   0   5   0  36   0 958]]
              precision    recall  f1-score   support

           0       0.89      0.88      0.89      1000
           1       0.99      0.99      0.99      1000
           2       0.92      0.90      0.91      1000
           3       0.93      0.94      0.94      1000
           4       0.89      0.93      0.91      1000
           5       0.99      0.99      0.99      1000
           6       0.81      0.81      0.81      1000
           7       0.96      0.98      0.97      1000
           8       0.99      0.98      0.99      1000
           9       0.98      0.96      0.97      1000

    accuracy                           0.94     10000
   macro avg       0.94      0.94      0.94     10000
weighted avg       0.94      0.94      0.94     10000




[[884   0  14  13   0   0  87   0   2   0]
 [  1 990   0   7   0   0   1   0   1   0]
 [ 14   1 909   9  29   0  37   0   1   0]
 [ 12   2   4 934  14   0  34   0   0   0]
 [  1   0  22  16 925   0  36   0   0   0]
 [  0   0   0   0   0 988   0   8   0   4]
 [ 85   2  40  18  45   0 807   0   3   0]
 [  0   0   0   0   0   2   0 988   0  10]
 [  2   1   2   1   1   2   4   0 985   2]
 [  1   0   0   0   0   4   0  36   0 959]]
              precision    recall  f1-score   support

           0       0.88      0.88      0.88      1000
           1       0.99      0.99      0.99      1000
           2       0.92      0.91      0.91      1000
           3       0.94      0.93      0.93      1000
           4       0.91      0.93      0.92      1000
           5       0.99      0.99      0.99      1000
           6       0.80      0.81      0.80      1000
           7       0.96      0.99      0.97      1000
           8       0.99      0.98      0.99      1000
           9       0.98      0.96      0.97      1000

    accuracy                           0.94     10000
   macro avg       0.94      0.94      0.94     10000
weighted avg       0.94      0.94      0.94     10000




